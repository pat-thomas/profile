#!/usr/bin/env ruby

require 'rubygems'
require 'base_app'
require 'fileutils'

class SetPair < BaseApp
  def pair_name
    if ARGV.join(" ").downcase.include? "and"
      ARGV.join(" ")
    else
      ARGV.join(" and ")
    end
  end

  def run
    gitconfig_file = "#{ENV['HOME']}/.gitconfig"
    lines = File.readlines(gitconfig_file)
    FileUtils.copy gitconfig_file, "#{ENV['HOME']}/.bak.gitconfig"
    lines.each do |line|
      line.gsub! /name = .+$/, "name = #{pair_name}"
    end
    File.open(gitconfig_file,"w") do |f|
      lines.each do |line|
        f.puts line
      end
    end

    if pair_name =~ /josh/i
      $stderr.puts "I _SURE_ LIKE IRISH SPRING!"
    end

    if pair_name =~ /kyle/i
      $stderr.puts [
        "ba ba ba ba boom!",
        "What's my model?"
      ].sample
    end

    if pair_name =~ /pat/i
      $stderr.puts "Is that a challenge?"
    end

    if pair_name =~ /linus/i
      $stderr.puts "I blame my pong loses on injuries"
    end

    if pair_name =~ /nick/i
      $stderr.puts "My farm share is a utopic paradise"
    end

    if pair_name =~ /paul/i
      $stderr.puts [
        "YUM YUM CHOCOLATE FRIDAY!", 
        "I _could_ take that kangaroo (https://www.youtube.com/watch?v=36tBS6dXo-U)"
      ].sample
    end

    if pair_name =~ /rich/i
      #$stderr.puts "If Minecraft had dinosaurs I would be soooo happy"
      $stderr.puts "Shall I Disable or Enable the demugger?"
    end
  end
end

SetPair.main
